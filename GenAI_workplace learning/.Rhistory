#   group_by(size,source) %>%
#   summarise(freq = n()) %>%
#   arrange(desc(freq)) %>%
#   mutate(percent = round(freq / sum(freq) * 100))
chi_size_impact <- table(stats_impact$size,stats_impact$impact)
chisq.test(chi_size_impact,correct=FALSE)
# # Create a bar chart for each size and method combination
# ggplot(stats_impact,
#        aes(x=size,
#            fill=impact))+
#   geom_bar(position='fill')+
#   coord_flip() +
#   labs(x = "", y = "", fill = "Impact of workplace learning")
#
# # Calculate percentage values for each size and method combination
# size_impact_t <- stats_impact %>%
#   group_by(size,impact) %>%
#   summarise(freq = n()) %>%
#   arrange(desc(freq)) %>%
#   mutate(percent = round(freq / sum(freq) * 100))
chi_size_tool <- table(stats_tool$size,stats_tool$tool)
chisq.test(chi_size_tool)$expected
stats_tool4 <- stats_tool[!(stats_tool$tool=="Others"),]
stats_tool4 <- stats_tool4[!(stats_tool4$tool=="EvoSuite"),]
stats_tool4 <- stats_tool4[!(stats_tool4$tool=="Tabnine"),]
stats_tool4 <- stats_tool4[!(stats_tool4$tool=="Codey"),]
# stats_tool4 <- stats_tool4[!(stats_tool4$tool=="Sketch2Code"),]
# stats_tool4 <- stats_tool4[!(stats_tool4$tool=="StarCoder"),]
chi_size_tool4 <- table(stats_tool4$size,stats_tool4$tool)
chisq.test(chi_size_tool4)$expected #some expected counts are less than 5, but no more than 20% of the expected counts are less than 5
chisq.test(chi_size_tool4,correct=FALSE)
# Create a bar chart for each size and method combination
ggplot(stats_tool4,
aes(x=size,
fill=tool))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "GenAI tools used for workplace learning")
# Calculate percentage values for each size and method combination
size_tool_t <- stats_tool4 %>%
group_by(size,tool) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
chi_size_factor <- table(stats_factor$size,stats_factor$factors)
chisq.test(chi_size_factor,correct=FALSE)
# # Create a bar chart for each size and method combination
# ggplot(stats_factor,
#        aes(x=size,
#            fill=factors))+
#   geom_bar(position='fill')+
#   coord_flip() +
#   labs(x = "", y = "", fill = "Factors important for GenAI")
#
# # Calculate percentage values for each size and method combination
# size_factor_t <- stats_factor %>%
#   group_by(size,factors) %>%
#   summarise(freq = n()) %>%
#   arrange(desc(freq)) %>%
#   mutate(percent = round(freq / sum(freq) * 100))
stats_task2 <- stats_task[,c("ID","task")]
stats_factor2 <- stats_factor[,c("ID","factors")]
task_factor <- merge(stats_task2,stats_factor2,by="ID")
chi_task_factor <- table(task_factor$task,task_factor$factors)
chisq.test(chi_task_factor,correct=FALSE)
stats_tool2 <- stats_tool[,c("ID","tool")]
task_tool <- merge(stats_task2,stats_tool2,by="ID")
chi_task_tool <- table(task_tool$task,task_tool$tool)
chisq.test(chi_task_tool,correct=FALSE)
stats_impact2 <- stats_impact[,c("ID","impact")]
task_impact <- merge(stats_task2,stats_impact2,by="ID")
chi_task_impact <- table(task_impact$task,task_impact$impact)
chisq.test(chi_task_impact,correct=FALSE)
stats_source2 <- stats_source[,c("ID","source")]
task_source <- merge(stats_task2,stats_source2,by="ID")
chi_task_source <- table(task_source$task,task_source$source)
chisq.test(chi_task_source,correct=FALSE)
stats_method2 <- stats_method[,c("ID","method")]
stats_method2$method <- replace(stats_method2$method,stats_method2$method=="Self-directed learning - independent study where learners set learning goals and materials","Self-directed learning")
stats_method2$method <- replace(stats_method2$method,stats_method2$method=="Formal training - structured educational programs often led by instructors, following a specific curriculum","Formal training")
stats_method2$method <- replace(stats_method2$method,stats_method2$method=="Collaborative learning - learning through group interaction, sharing knowledge and skills","Collaborative learning")
task_method <- merge(stats_task2,stats_method2,by="ID")
chi_task_method <- table(task_method$task,task_method$method)
chisq.test(chi_task_method)$expected #some expected counts are less than 5, but no more than 20% of the expected counts are less than 5
task_method2 <- task_method[!(task_method$method=="Others"),]
chi_task_method2 <- table(task_method2$task,task_method2$method)
chisq.test(chi_task_method2,correct=FALSE)
# Create a bar chart for each size and method combination
ggplot(task_method2,
aes(x=task,
fill=method))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "Workplace learning formats")
# Calculate percentage values for each size and method combination
task_method_t <- task_method2 %>%
group_by(task,method) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
# edu_method <- stats_edu[complete.cases(stats_edu$ID, stats_edu$education), ]
stats_edu2 <- stats_edu[,c("ID","education")]
edu_method <- merge(stats_edu2,stats_method2,by="ID")
chi_edu_method <- table(edu_method$education,edu_method$method)
chisq.test(chi_edu_method)$expected
edu_method2 <- edu_method[!(edu_method$method=="Others"),]
chi_edu_method2 <- table(edu_method2$education,edu_method2$method)
chisq.test(chi_edu_method2)$expected #no more than 20% of the expected counts are less than 5
chisq.test(chi_edu_method2,correct=FALSE)
# Calculate percentage values for each size and method combination
edu_method_t <- edu_method2 %>%
group_by(education,method) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(edu_method2,
aes(x=education,
fill=method))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "Workplace learning formats")
stats_source2 <- stats_source[,c("ID","source")]
edu_source <- merge(stats_edu2,stats_source2,by="ID")
chi_edu_source <- table(edu_source$education,edu_source$source)
chisq.test(chi_edu_source,correct=FALSE)
stats_impact2 <- stats_impact[,c("ID","impact")]
edu_impact <- merge(stats_edu2,stats_impact2,by="ID")
chi_edu_impact <- table(edu_impact$education,edu_impact$impact)
chisq.test(chi_edu_impact,correct=FALSE)
# edu_tool <- merge(stats_edu2,stats_tool2,by="ID")
# chi_edu_tool <- table(edu_tool$education,edu_tool$tool)
# chisq.test(chi_edu_tool)$expected
edu_tool2 <- merge(stats_edu2,stats_tool2,by="ID")
edu_tool2 <- edu_tool2[!(edu_tool2$tool=="Others"),]
edu_tool2 <- edu_tool2[!(edu_tool2$tool=="EvoSuite"),]
edu_tool2 <- edu_tool2[!(edu_tool2$tool=="Tabnine"),]
edu_tool2 <- edu_tool2[!(edu_tool2$tool=="Codey"),]
chi_edu_tool2 <- table(edu_tool2$education,edu_tool2$tool)
chisq.test(chi_edu_tool2)$expected
chisq.test(chi_edu_tool2,correct=FALSE)
# Calculate percentage values for each size and method combination
edu_tool_t <- edu_tool2 %>%
group_by(education,tool) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(edu_tool2,
aes(x=education,
fill=tool))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "GenAI tools used for workplace learning")
stats_factor2 <- stats_factor[,c("ID","factors")]
edu_factor <- merge(stats_edu2,stats_factor2,by="ID")
chi_edu_factor <- table(edu_factor$education,edu_factor$factor)
chisq.test(chi_edu_factor,correct=FALSE)
# # Calculate percentage values for each size and method combination
# edu_tool_t <- edu_tool %>%
#   group_by(education,tool) %>%
#   summarise(freq = n()) %>%
#   arrange(desc(freq)) %>%
#   mutate(percent = round(freq / sum(freq) * 100))
stats_age2 <- stats_age[,c("ID","age")]
age_factor <- merge(stats_age2,stats_factor2,by="ID")
chi_age_factor <- table(age_factor$age,age_factor$factor)
chisq.test(chi_age_factor,correct=FALSE)
age_tool <- merge(stats_age2,stats_tool2,by="ID")
chi_age_tool <- table(age_tool$age,age_tool$tool)
chisq.test(chi_age_tool,correct=FALSE)
age_impact <- merge(stats_age2,stats_impact2,by="ID")
chi_age_impact <- table(age_impact$age,age_impact$impact)
chisq.test(chi_age_impact,correct=FALSE)
age_source <- merge(stats_age2,stats_source2,by="ID")
chi_age_source <- table(age_source$age,age_source$source)
chisq.test(chi_age_source,correct=FALSE)
age_method <- merge(stats_age2,stats_method2,by="ID")
#old <- c("55-64","65 and over")
age_method <- age_method %>% mutate(age_g=ifelse(age=="25-34", "25-34", ifelse(age=="18-24", "18-24", ifelse(age=="35-44","35-44", "45 and over"))))
age_method2 <- age_method[!(age_method$method=="Others"),]
chi_age_method <- table(age_method2$age_g,age_method2$method)
chisq.test(chi_age_method)$expected #no more than 20% of the expected counts are less than 5
chisq.test(chi_age_method,correct=FALSE)
n_distinct(age_method2$ID)
# Calculate percentage values for each size and method combination
age_method_t <- age_method2 %>%
group_by(age_g,method) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(age_method2,
aes(x=age_g,
fill=method))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "Workplace learning formats") +
scale_fill_npg()
stats_gender2 <- stats_gender[,c("ID","gender")]
gender_method <- merge(stats_gender2,stats_method2,by="ID")
gender_method2 <- gender_method[!(gender_method$gender=="Nonbinary"),]
gender_method2 <- gender_method2[!(gender_method2$method=="Others"),]
chi_gender_method2 <- table(gender_method2$gender,gender_method2$method)
chisq.test(chi_gender_method2,correct=FALSE)
n_distinct(gender_method2$ID)
# Calculate percentage values for each size and method combination
gender_method_t <- gender_method2 %>%
group_by(gender,method) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(gender_method2,
aes(x=gender,
fill=method))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "Workplace learning formats")
gender_source <- merge(stats_gender2,stats_source2,by="ID")
chi_gender_source <- table(gender_source$gender,gender_source$source)
chisq.test(chi_gender_source,correct=FALSE)
gender_impact <- merge(stats_gender2,stats_impact2,by="ID")
chi_gender_impact <- table(gender_impact$gender,gender_impact$impact)
chisq.test(chi_gender_impact,correct=FALSE)
gender_tool <- merge(stats_gender2,stats_tool2,by="ID")
chi_gender_tool <- table(gender_tool$gender,gender_tool$tool)
chisq.test(chi_gender_tool,correct=FALSE)
gender_factor <- merge(stats_gender2,stats_factor2,by="ID")
chi_gender_factor <- table(gender_factor$gender,gender_factor$factor)
chisq.test(chi_gender_factor,correct=FALSE)
# Selecting ID and ethnicity from stats_eth dataframe
stats_eth2 <- stats_eth[, c("ID", "ethnicity")]
# Merging ethnicity with method data
ethnicity_method <- merge(stats_eth2, stats_method2, by = "ID")
# Creating contingency table for method
chi_ethnicity_method <- table(ethnicity_method$ethnicity, ethnicity_method$method)
# Merging ethnicity with source data
ethnicity_source <- merge(stats_eth2, stats_source2, by = "ID")
# Creating contingency table for source
chi_ethnicity_source <- table(ethnicity_source$ethnicity, ethnicity_source$source)
# Merging ethnicity with impact data
ethnicity_impact <- merge(stats_eth2, stats_impact2, by = "ID")
# Creating contingency table for impact
chi_ethnicity_impact <- table(ethnicity_impact$ethnicity, ethnicity_impact$impact)
# Merging ethnicity with tool data
ethnicity_tool <- merge(stats_eth2, stats_tool2, by = "ID")
# Creating contingency table for tool
chi_ethnicity_tool <- table(ethnicity_tool$ethnicity, ethnicity_tool$tool)
# Merging ethnicity with factor data
ethnicity_factor <- merge(stats_eth2, stats_factor2, by = "ID")
# Creating contingency table for factor
chi_ethnicity_factor <- table(ethnicity_factor$ethnicity, ethnicity_factor$factor)
# Printing chi-square test results for each dependent variable
print(chisq.test(chi_ethnicity_method, correct = FALSE))
print(chisq.test(chi_ethnicity_source, correct = FALSE))
print(chisq.test(chi_ethnicity_impact, correct = FALSE))
print(chisq.test(chi_ethnicity_tool, correct = FALSE))
print(chisq.test(chi_ethnicity_factor, correct = FALSE))
# cleaned_df <- df[complete.cases(df$ID, df$Name), ]
ethnicity_method2 <- ethnicity_method[!(ethnicity_method$method=="Others"),]
ethnicity_method2 <- ethnicity_method2[!(ethnicity_method2$ethnicity=="Native Hawaiian or Other Pacific Islander"),]
chi_ethnicity_method2 <- table(ethnicity_method2$ethnicity, ethnicity_method2$method)
chisq.test(chi_ethnicity_method2)$expected
chisq.test(chi_ethnicity_method2,correct = FALSE)
n_distinct(ethnicity_method2$ID)
# Calculate percentage values for each size and method combination
eth_method_t <- ethnicity_method2 %>%
group_by(ethnicity,method) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(ethnicity_method2,
aes(x=ethnicity,
fill=method))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "Workplace learning formats") +
scale_fill_npg()
n_distinct(ethnicity_tool$ID)
# Calculate percentage values for each size and method combination
eth_tool_t <- ethnicity_tool %>%
group_by(ethnicity,tool) %>%
summarise(freq = n()) %>%
arrange(desc(freq)) %>%
mutate(percent = round(freq / sum(freq) * 100))
ggplot(ethnicity_tool,
aes(x=ethnicity,
fill=tool))+
geom_bar(position='fill')+
coord_flip() +
labs(x = "", y = "", fill = "GenAI tools used for workplace learning")
#split codebook dataset
code_theme <- codebook[,c(1,14:18)]
#change the structure of the codetheme dataset - long format
melt_data <- reshape2::melt(code_theme, id = c("ID"))
melt_data <- melt_data %>% separate_rows(value, sep = ",")
melt_data <- melt_data[!(melt_data$value==""),]
#remove spaces in rows & empty rows
melt_data$value <- str_trim(melt_data$value, side='left')
melt_data <- melt_data[which(!is.na(melt_data$value)),]
#change colnames of theme
colnames(theme) <- c("value", "theme", "variable")
theme$variable <- tolower(theme$variable)
#merge data melt_data & theme
data <- merge(melt_data, theme, by=c("variable","value"),all.x = TRUE )
#merge data with stats
data2 <- merge(data, stats, by="ID")
#creating contingency table
data2 <- data2[!is.na(data2$theme),]
#create a subset of data
tasks <- subset(data2,variable=="tasks")
actions <- subset(data2,variable=="actions")
rationales <- subset(data2,variable=="rationales")
challenges <- subset(data2,variable=="challenges")
outcomes <- subset(data2,variable=="outcomes")
#tasks-age
chi_age_theme <- table(tasks$age, tasks$theme)
print(chisq.test(chi_age_theme, correct = FALSE))
# tasks-level
chi_level_theme <- table(tasks$level, tasks$theme)
print(chisq.test(chi_level_theme, correct = FALSE))
# tasks-size
chi_size_theme <- table(tasks$size, tasks$theme)
print(chisq.test(chi_size_theme, correct = FALSE))
# tasks-gender
chi_gender_theme <- table(tasks$gender, tasks$theme)
print(chisq.test(chi_gender_theme, correct = FALSE))
# tasks-ethnicity
chi_ethnicity_theme <- table(tasks$ethnicity, tasks$theme)
print(chisq.test(chi_ethnicity_theme, correct = FALSE))
# tasks-education
chi_education_theme <- table(tasks$education, tasks$theme)
print(chisq.test(chi_education_theme, correct = FALSE))
# actions-age
chi_age_actions <- table(actions$age, actions$theme)
print(chisq.test(chi_age_actions, correct = FALSE))
# actions-level
chi_level_actions <- table(actions$level, actions$theme)
print(chisq.test(chi_level_actions, correct = FALSE))
# actions-size
chi_size_actions <- table(actions$size, actions$theme)
print(chisq.test(chi_size_actions, correct = FALSE))
# actions-gender
chi_gender_actions <- table(actions$gender, actions$theme)
print(chisq.test(chi_gender_actions, correct = FALSE))
# actions-ethnicity
chi_ethnicity_actions <- table(actions$ethnicity, actions$theme)
print(chisq.test(chi_ethnicity_actions, correct = FALSE))
# actions-education
chi_education_actions <- table(actions$education, actions$theme)
print(chisq.test(chi_education_actions, correct = FALSE))
# Rationales for age
chi_age_theme <- table(rationales$age, rationales$theme)
print(chisq.test(chi_age_theme, correct = FALSE))
# Rationales for level
chi_level_theme <- table(rationales$level, rationales$theme)
print(chisq.test(chi_level_theme, correct = FALSE))
# Rationales for size
chi_size_theme <- table(rationales$size, rationales$theme)
print(chisq.test(chi_size_theme, correct = FALSE))
# Rationales for gender
chi_gender_theme <- table(rationales$gender, rationales$theme)
print(chisq.test(chi_gender_theme, correct = FALSE))
# Rationales for ethnicity
chi_ethnicity_theme <- table(rationales$ethnicity, rationales$theme)
print(chisq.test(chi_ethnicity_theme, correct = FALSE))
# Rationales for education
chi_education_theme <- table(rationales$education, rationales$theme)
print(chisq.test(chi_education_theme, correct = FALSE))
# challenges-age
chi_age_theme <- table(challenges$age, challenges$theme)
print(chisq.test(chi_age_theme, correct = FALSE))
# challenges-level
chi_level_theme <- table(challenges$level, challenges$theme)
print(chisq.test(chi_level_theme, correct = FALSE))
# challenges-size
chi_size_theme <- table(challenges$size, challenges$theme)
print(chisq.test(chi_size_theme, correct = FALSE))
# challenges-gender
chi_gender_theme <- table(challenges$gender, challenges$theme)
print(chisq.test(chi_gender_theme, correct = FALSE))
# challenges-ethnicity
chi_ethnicity_theme <- table(challenges$ethnicity, challenges$theme)
print(chisq.test(chi_ethnicity_theme, correct = FALSE))
# challenges-education
chi_education_theme <- table(challenges$education, challenges$theme)
print(chisq.test(chi_education_theme, correct = FALSE))
# outcomes-age
chi_age_theme <- table(outcomes$age, outcomes$theme)
print(chisq.test(chi_age_theme, correct = FALSE))
# outcomes-level
chi_level_theme <- table(outcomes$level, outcomes$theme)
print(chisq.test(chi_level_theme, correct = FALSE))
# outcomes-size
chi_size_theme <- table(outcomes$size, outcomes$theme)
print(chisq.test(chi_size_theme, correct = FALSE))
# outcomes-gender
chi_gender_theme <- table(outcomes$gender, outcomes$theme)
print(chisq.test(chi_gender_theme, correct = FALSE))
# outcomes-ethnicity
chi_ethnicity_theme <- table(outcomes$ethnicity, outcomes$theme)
print(chisq.test(chi_ethnicity_theme, correct = FALSE))
# outcomes-education
chi_education_theme <- table(outcomes$education, outcomes$theme)
print(chisq.test(chi_education_theme, correct = FALSE))
# b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, percent), y = percent, fill = factors)) +
#   geom_bar(stat = "identity", fill="darkblue") +
#   geom_text(aes(label = paste0(percent, "%")), hjust = -0.5, size = 2.5) +
#   labs(x = "", y = "", title = "") +
#   scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
#   theme_minimal() +
#   theme(legend.position = "none",
#         axis.text.x = element_text(hjust = 1))+
#   coord_flip()
df_factor <- df_factor %>% mutate(Label = paste0(freq, " ", "(", percent, "%)"))
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,150) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
ggsave(b_factor2, filename="value_rev.jpg", device="jpg", width = 12, height = 6, dpi = 1200)
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,120) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,110) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,130) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,120) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,150) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
b_factor2 <- ggplot(df_factor, aes(x = reorder(factors, freq), y = freq, fill = factors)) +
geom_bar(stat = "identity", fill="darkblue") +
ylim(0,130) +
geom_text(aes(label = Label), hjust = -0.1, size = 5, fontface = "bold") +
labs(x = "", y = "", title = "") +
#scale_y_continuous(labels = scales::percent_format(scale = 1, accuracy = 1)) +
theme_minimal() +
theme(
text = element_text(size = 15, face = "bold"),
legend.position = "none",
axis.text.x = element_text(size = 15, face = "bold"),
axis.text.y = element_text(size = 15, face = "bold")) +
coord_flip()
b_factor2
ggsave(b_factor2, filename="value_rev.jpg", device="jpg", width = 12, height = 6, dpi = 1200)
